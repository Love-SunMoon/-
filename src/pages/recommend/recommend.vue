<template><view class="head">  <titles>小编推荐</titles>  <view class="category">    <view class="category__item"          :class="{active: index === checked}"          v-for="(i,index) in category" :key="i"          @click="handleCategoryClick(index)">{{i.name}}</view>  </view></view>  <view class="contents">    <view class="content" v-for="item in data" :key="item.id">      <view class="content__top">        <image class="content__icon" :src="item.avatar"></image>        <view class="content__title">{{ item.name }}</view>        <view class="content__time">{{ handelTime(item.publish_timestamp) }}分钟前</view>      </view>      <view class="content__info">        <text v-for="text in ((item.content).split('\n'))" style="display: block">{{text}}</text>        <view class="content__images">          <view :style="{height: ((item.share_pic.length <= 1) ? 'auto': '')}" class="content__images__container" v-for="img in item.share_pic">            <image mode="widthFix" class="content__images__item" :src="img"></image>          </view>       </view>      </view>      <view class="goods" @click="goToDetailPage(item.goods[0])">        <image class="goods__image" :src="item.goods[0].pic"></image>        <view class="container">          <view class="goods__title">{{ item.goods[0].title }}</view>          <view class="goods__center">            <view class="goods__left">              <view class="goods__price">                券后<view style="display: flex;padding-left: 6rpx;color: #fe3738;align-items: baseline">¥ <view style="font-size: 30rpx">{{ item.goods[0].jiage }}</view></view>              </view>              <view class="goods__coupon">                <view style="                color: #fe3a33;                background-color: #fff;                padding:6rpx;                box-sizing: border-box;                line-height: 1;                ">券</view>                <view style="                padding:6rpx;                line-height: 1;                ">{{item.goods[0].quan_jine}}元</view>              </view>            </view>            <view class="goods__right">              <view class="goods__button">立即抢</view>            </view>          </view>          <view class="goods__bottom">            <view class="goods__lineation">¥{{item.goods[0].yuanjia}}</view>            <view class="goods__volume">已售{{item.goods[0].xiaoliang}}</view>          </view>        </view>      </view>    </view>  </view>  <scroll-top></scroll-top></template><script>import { getRecommendData } from '../../network/requests';import titles from '../basic/title';import {ref} from 'vue';import ScrollTop from "../basic/scrollTop";import {handleDataCache, scrollToLowerLoad} from "../../static/common";export default {  name: "recommend",  components: {    ScrollTop,    titles  },  setup (props, context) {    const category = [      {name: '精选', category_id: 0},      {name: '吃货福利', category_id: 11},      {name: '日用百货', category_id: 12},      {name: '个妆每护', category_id: 13},      {name: '母婴亲子', category_id: 14}    ]    const checked = ref(0)    let params = {      category_id: category[0].category_id,      page: 1,      page_size: 10    }    const handleCategoryClick = function (index) {      checked.value = index      params.category_id = category[checked.value].category_id      handleCache(index)    }    let data = ref([])    const getData = function () {      console.log(params);      getRecommendData(params).then((result, error) => {        if (error) {          console.log('错误详情：' + error);          return        }        data.value.push(...result.data.data.data)        params.page += 1      })    }    getData()    const goToDetailPage = function (info) {      console.log(info);      uni.navigateTo({        url: '/pages/goods/goods?goodsId=' + info.goodsid      })    }    const handleCache = handleDataCache(data, checked.value, getData, params)    scrollToLowerLoad(".contents", getData, 150)    const handelTime = function (publishTimestamp) {      return Math.floor(Math.round((new Date().getTime() / 1000) - publishTimestamp) / 60)    }    return {      category,      checked,      handleCategoryClick,      data,      handelTime,      goToDetailPage    }  },}</script><style scoped lang="scss">.head {  position: fixed;  width: 100%;  z-index: 100;}.category {  display: flex;  height: 88rpx;  align-items:center;  justify-content: space-evenly;  background-color: #fff;  .active {    color: #fff;    border-radius: 11.5px;    background-image: linear-gradient(270deg,#fe3c35,#ff1f4c);  }  &__item {    font-size: 26rpx;    color: #333;    font-weight: 500;    padding: 0 20rpx;    height: 48rpx;    line-height: 48rpx;  }}.contents {  padding-top: 176rpx;  background-color: #f5f5f9;  .content {    padding: 32rpx 30rpx;    margin: 20rpx;    border-radius: 10px;    background-color: #fff;    &__top {      margin-bottom: 24rpx;    }    &__icon {      width: 84rpx;      height: 84rpx;      border-radius: 50%;      margin-right: 20rpx;      float: left;    }    &__title {      font-size: 30rpx;      color: #333;    }    &__time {      color: #999;      font-size: 24rpx;    }    &__info {      display: inline-block;      font-size: 28rpx;      .content__images {        display: flex;        flex-wrap: wrap;        //justify-content: space-between;        padding-top: 20rpx;        &__container {          overflow: hidden;          height: 210rpx;          width: 33.3%;          margin-bottom: 6rpx;          border-radius: 10px;          .content__images__item {            width: 210rpx;            border-radius: 10px;          }        }      }    }    .goods {      border-radius: 10px;      padding: 10rpx;      margin-top: 10rpx;      background-color: #f5f5f5;      display: flex;      .container {        display: flex;        flex-direction: column;        justify-content: space-around;        width: calc(100% - 150rpx);        padding: 10rpx;        box-sizing: border-box;      }      &__image {        width: 150rpx;        height: 150rpx;      }      &__title {        font-size: 24rpx;        width: 420rpx;        text-overflow: ellipsis;        white-space: nowrap;        overflow: hidden;        color: #333;        flex: 1;      }      &__center,      &__left,      &__bottom      {        display: flex;      }      &__center,      &__bottom      {        justify-content: space-between;      }      &__price {        font-size: 24rpx;        color: #666;        display: flex;        align-items: baseline;        margin-right: 10rpx;      }      &__coupon {        font-size: 24rpx;        background-image: linear-gradient(90deg,#ff8873 2%,#ff4f4f 98%);        color: #fff;        border-radius: 2px;        display: flex;        padding: 3rpx 4rpx;        margin-left: 1rpx;        box-sizing: border-box;      }      &__button {        font-size: 24rpx;        color: #fff;        width: 124rpx;        line-height: 42rpx;        background-image: linear-gradient(270deg,#fe3c35,#ff1f4c);        text-align: center;        border-radius: 5px;        font-weight: 500;      }      &__bottom {        font-size: 24rpx;        color: #888;        margin-top: 4rpx;      }      &__lineation {        text-decoration: line-through;      }    }  }}</style>